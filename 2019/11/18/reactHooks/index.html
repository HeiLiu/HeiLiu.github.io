<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>React Hookå­¦ä¹  - HeiLiu</title>
    <meta charset="UTF-8">
    <meta name="description" content="ä¸€ç›´åœ¨è·¯ä¸Šçš„ç¨‹åºå‘˜">
    <meta name="keywords" content="åšå®¢ ç¨‹åºå‘˜ åˆ†äº«">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="Hooks åœ¨React 16.8 ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­æ‰å¯ä»¥ä½¿ç”¨  eslint-plugin-react-hooks Hook å®šä¹‰ Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="React Hookå­¦ä¹ ">
<meta property="og:url" content="https://heiliu.github.io/2019/11/18/reactHooks/">
<meta property="og:site_name" content="HeiLiu">
<meta property="og:description" content="Hooks åœ¨React 16.8 ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­æ‰å¯ä»¥ä½¿ç”¨  eslint-plugin-react-hooks Hook å®šä¹‰ Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-11-18T04:59:41.324Z">
<meta property="article:modified_time" content="2021-08-25T12:28:06.219Z">
<meta property="article:author" content="å°åˆ«è‡´çœŸä¸œè¥¿">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,npm/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css?v=233" crossorigin>
    <link rel="stylesheet" href="/css/style.css?v=1630502052181">
    
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1630502052181">
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.pixabay.com/photo/2021/08/20/20/05/mountains-6561191__480.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="å°åˆ«è‡´çœŸä¸œè¥¿" class="mdui-btn mdui-btn-icon"><img src="https://avatars1.githubusercontent.com/u/29034936?s=400&amp;u=568e2bb8e4bb03a573e9138e715699e492fbe399&amp;v=4" alt="å°åˆ«è‡´çœŸä¸œè¥¿"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="å°åˆ«è‡´çœŸä¸œè¥¿">
            <img src="https://avatars1.githubusercontent.com/u/29034936?s=400&amp;u=568e2bb8e4bb03a573e9138e715699e492fbe399&amp;v=4" alt="å°åˆ«è‡´çœŸä¸œè¥¿" alt="å°åˆ«è‡´çœŸä¸œè¥¿">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>æ–‡ç« </span>77</div>
        <div><span>æ ‡ç­¾</span>31</div>
        <div><span>åˆ†ç±»</span>26</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="å›åˆ°é¦–é¡µ">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                å›åˆ°é¦–é¡µ
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive/" title="æ–‡ç« å½’æ¡£">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                æ–‡ç« å½’æ¡£
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about/" title="å…³äºåšå®¢">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                å…³äºåšå®¢
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="æœç´¢"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://github.com/heiliu/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a><a class="mdui-ripple" href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=969403750&website=www.oicqzone.com" target="_blank" mdui-tooltip="{content: 'QQ'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/Css/" style="font-size: 12.5px;">Css</a> <a href="/tags/Css3/" style="font-size: 10px;">Css3</a> <a href="/tags/E2E%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">E2Eæµ‹è¯•</a> <a href="/tags/Flex/" style="font-size: 10px;">Flex</a> <a href="/tags/Foo/" style="font-size: 10px;">Foo</a> <a href="/tags/Git/" style="font-size: 17.5px;">Git</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/NPM/" style="font-size: 10px;">NPM</a> <a href="/tags/Note/" style="font-size: 15px;">Note</a> <a href="/tags/Quote/" style="font-size: 10px;">Quote</a> <a href="/tags/React/" style="font-size: 17.5px;">React</a> <a href="/tags/React-router/" style="font-size: 10px;">React-router</a> <a href="/tags/Skill/" style="font-size: 10px;">Skill</a> <a href="/tags/Test/" style="font-size: 10px;">Test</a> <a href="/tags/Vue/" style="font-size: 10px;">Vue</a> <a href="/tags/WebPack/" style="font-size: 10px;">WebPack</a> <a href="/tags/Yarn/" style="font-size: 10px;">Yarn</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/redux/" style="font-size: 10px;">redux</a> <a href="/tags/%E5%80%92%E8%85%BE/" style="font-size: 12.5px;">å€’è…¾</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 17.5px;">å‰ç«¯</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 12.5px;">å°ç¨‹åº</a> <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 10px;">æ€§èƒ½ä¼˜åŒ–</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">ç¬”è®°</a> <a href="/tags/%E8%A7%84%E5%88%92/" style="font-size: 10px;">è§„åˆ’</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 10px;">éšç¬”</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 12.5px;">é¢è¯•</a> <a href="/tags/%F0%9F%8C%9D/" style="font-size: 12.5px;">ğŸŒ</a>
    </div>
    
  </div>

    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æ–‡ç« åˆ†ç±»</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Skill/Git/">Git</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JSè¯­è¨€ç²¾ç²¹/">JSè¯­è¨€ç²¾ç²¹</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Skill/JavaScript/">JavaScript</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/NPM/">NPM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Nodeæœ€ä½³å®è·µ/">Nodeæœ€ä½³å®è·µ</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Skill/Note/">Note</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/React/">React</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Skill/">Skill</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Test/">Test</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å‰ç«¯/Vue/">Vue</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/hexo/">hexo</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å‰ç«¯/webPack/">webPack</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å€’è…¾/">å€’è…¾</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å‰ç«¯/">å‰ç«¯</a>
          <span class="category-list-count">16</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/å°ç¨‹åº/">å°ç¨‹åº</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æœ‰æ„Ÿ/">æœ‰æ„Ÿ</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ç”Ÿæ´»/">ç”Ÿæ´»</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ç¬”è®°/">ç¬”è®°</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/é¢è¯•/">é¢è¯•</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2021 å°åˆ«è‡´çœŸä¸œè¥¿
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 52.77777777777778%;"> 
              <img data-src="https://cdn.pixabay.com/photo/2021/08/20/20/05/mountains-6561191__480.jpg" data-sizes="auto" alt="React Hookå­¦ä¹ " class="lazyload">
              <h1>React Hookå­¦ä¹ </h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2019å¹´11æœˆ18æ—¥</a>
    <a><i class="nexmoefont icon-areachart"></i>2.6k å­—</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>å¤§æ¦‚ 12 åˆ†é’Ÿ</a>
</div>

      

      <p>  Hooks åœ¨React <strong>16.8</strong> ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­æ‰å¯ä»¥ä½¿ç”¨<br>  <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/eslint-plugin-react-hooks">eslint-plugin-react-hooks</a></p>
<h2 id="Hook-å®šä¹‰"><a href="#Hook-å®šä¹‰" class="headerlink" title="Hook å®šä¹‰"></a>Hook å®šä¹‰</h2><blockquote>
<p>Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„<code>å‡½æ•°</code>ã€‚  </p>
</blockquote>
<span id="more"></span>
<p>   Hook ä¸èƒ½åœ¨ class ç»„ä»¶ä¸­ä½¿ç”¨ â€”â€” å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚<br>   ä½¿ç»„ä»¶è‡ªèº«åœ¨åˆæ¬¡ render ä¹‹åï¼Œèƒ½å¤Ÿé€šè¿‡ Hook æœºåˆ¶å†è§¦å‘çŠ¶æ€çš„å˜æ›´å¹¶ä¸”å¼•èµ·re-renderã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Hookç±»å‹å®šä¹‰ é“¾è¡¨</span><br>type Hook = &#123;<br>  <span class="hljs-attr">memoizedState</span>: any, <span class="hljs-comment">// å­˜å‚¨æœ€æ–°çš„state é“¾è¡¨</span><br>  <span class="hljs-attr">baseState</span>: any,<br>  <span class="hljs-attr">baseUpdate</span>: Update&lt;any, any&gt; | <span class="hljs-literal">null</span>,<br>  <span class="hljs-attr">queue</span>: UpdateQueue&lt;any, any&gt; | <span class="hljs-literal">null</span>, <span class="hljs-comment">// æ›´æ–°é˜Ÿåˆ—</span><br>  <span class="hljs-attr">next</span>: Hook | <span class="hljs-literal">null</span>, <span class="hljs-comment">// ä¸‹ä¸€ä¸ªhook</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="React-å¹¶ä¸ä¼šæ”¾å¼ƒ-class"><a href="#React-å¹¶ä¸ä¼šæ”¾å¼ƒ-class" class="headerlink" title="React å¹¶ä¸ä¼šæ”¾å¼ƒ class"></a>React å¹¶ä¸ä¼šæ”¾å¼ƒ class</h3><h4 id="Class-çš„ç¼ºé™·ï¼š"><a href="#Class-çš„ç¼ºé™·ï¼š" class="headerlink" title="Class çš„ç¼ºé™·ï¼š"></a>Class çš„ç¼ºé™·ï¼š</h4><ul>
<li>this çš„æŒ‡å‘é—®é¢˜ï¼Œåœ¨å‡½æ•°ç»„ä»¶çš„ç¼–å†™ä¸­ç»å¸¸ä¼šç¢°åˆ°thisçš„æŒ‡å‘é—®é¢˜ </li>
<li>ç¼–è¯‘è¿‡åçš„ä»£ç å¤§å° </li>
<li>Javascriptå®ç°çš„ç±»æœ¬èº«æ¯”è¾ƒé¸¡è‚‹ï¼Œæ²¡æœ‰ç±»ä¼¼Java/C++å¤šç»§æ‰¿çš„æ¦‚å¿µï¼Œç±»çš„é€»è¾‘å¤ç”¨æ˜¯ä¸ªé—®é¢˜ </li>
<li>Class Componentåœ¨Reactå†…éƒ¨æ˜¯å½“åšJavascript Functionç±»æ¥å¤„ç†çš„</li>
</ul>
<h2 id="Hook-ä½¿ç”¨è§„åˆ™"><a href="#Hook-ä½¿ç”¨è§„åˆ™" class="headerlink" title="Hook ä½¿ç”¨è§„åˆ™"></a>Hook ä½¿ç”¨è§„åˆ™</h2><p>  Hook å°±æ˜¯ JavaScript å‡½æ•°ï¼Œä½†æ˜¯ä½¿ç”¨å®ƒä»¬ä¼šæœ‰ä¸¤ä¸ªé¢å¤–çš„è§„åˆ™ï¼š</p>
<ul>
<li><p>åªèƒ½åœ¨å‡½æ•°æœ€å¤–å±‚è°ƒç”¨ Hookã€‚<strong>ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨</strong>ã€‚</p>
</li>
<li><p><code>åªèƒ½</code>åœ¨ React çš„å‡½æ•°ç»„ä»¶æˆ–è€…è‡ªå®šä¹‰çš„Hookä¸­è°ƒç”¨ Hookã€‚</p>
<p>åœ¨å®é™…ç¼–å†™åº•å±‚ç»„ä»¶åº“ä¸­å¸¸å¸¸ä¼šé…åˆ useState Hook è¿›è¡Œæµ‹è¯•, å› ä¸ºæˆ‘ä»¬çš„æœ€åº•å±‚çš„ç»„ä»¶é€šå¸¸åº”è¯¥æ˜¯è¢«è®¾è®¡æˆ <code>stateless</code> çš„ï¼Œéœ€è¦å¤–éƒ¨ä¼ å…¥props è¿›è¡Œæ§åˆ¶æµ‹è¯•</p>
</li>
</ul>
<h2 id="ç›¸å…³-Hook-çš„ä½¿ç”¨"><a href="#ç›¸å…³-Hook-çš„ä½¿ç”¨" class="headerlink" title="ç›¸å…³ Hook çš„ä½¿ç”¨"></a>ç›¸å…³ Hook çš„ä½¿ç”¨</h2><h3 id="useState-Hook"><a href="#useState-Hook" class="headerlink" title="useState Hook"></a>useState Hook</h3><p>  åœ¨å‡½æ•°ç»„ä»¶ä¸­ã€é€šè¿‡ useState Hook å¯ä»¥ä½¿ç”¨åœ¨ class ä¸­çš„ state ç‰¹æ€§ï¼›å‡½æ•°é€€å‡ºåã€state ä¸­çš„å˜é‡ä¼šè¢« React ä¿ç•™ï¼›usetState è¿”å›ä¸€ä¸ªçŠ¶æ€ä»¥åŠè¿™ä¸ªçŠ¶æ€çš„ setter æ–¹æ³•ï¼Œ</p>
<p><strong>åˆå§‹åŒ–</strong><br>ä¸€  </p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> [state, setState] = useState(initialState)<br></code></pre></td></tr></table></figure>
<p>äºŒ<br>åœ¨åˆå§‹åŒ–çš„æ—¶å€™ã€å¦‚æœstateéœ€è¦é€šè¿‡è®¡ç®—è·å¾—ã€æˆ–è€…éœ€è¦è¿›è¡Œæ¯”è¾ƒ expensive çš„è®¡ç®—ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ã€‚<br>è¿™ä¸ª initialState å‚æ•°åªä¼šåœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“ä¸­èµ·ä½œç”¨ï¼Œåç»­æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> [state, setState] = useState(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> initialState = someExpensiveComputation(props);<br>  <span class="hljs-keyword">return</span> initialState;<br>&#125;);<br></code></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Table</span>(<span class="hljs-params">props</span>) </span>&#123;<br>  <span class="hljs-comment">// âš ï¸ createRows() æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨</span><br>  <span class="hljs-keyword">const</span> [rows, setRows] = useState(createRows(props.count));<br>  <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Table</span>(<span class="hljs-params">props</span>) </span>&#123;<br>  <span class="hljs-comment">// âœ… createRows() åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡</span><br>  <span class="hljs-keyword">const</span> [rows, setRows] = useState(<span class="hljs-function">() =&gt;</span> createRows(props.count));<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹çŠ¶æ€</strong></p>
<ul>
<li>state åˆå§‹åŒ–ä¹‹ååªèƒ½é€šè¿‡è¿™ä¸ª setter ä¿®æ”¹å¯¹åº”è¿™ä¸ª stateã€‚  </li>
<li>æ¡†æ¶å†…éƒ¨ä¼šå¯¹å¤šæ¬¡ setter æ“ä½œè¿›è¡Œåˆå¹¶ï¼ˆå¾ªç¯æ‰§è¡Œä¼ å…¥çš„setterï¼Œç›®çš„æ˜¯ä¿è¯ useState æ‹¿åˆ°æœ€æ–°çš„çŠ¶æ€ï¼‰</li>
<li>state æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨å¯¹è±¡ã€æ•°ç»„çš„å½¢å¼ã€åœ¨ä¿®æ”¹stateçš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œ<strong>ç›¸è¾ƒäº setState éè¦†ç›–å¼æ›´æ–°çŠ¶æ€ï¼ŒuseState è¦†ç›–å¼æ›´æ–°çŠ¶æ€(ä¼šæ›¿æ¢ state çš„å€¼)ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±å¤„ç†é€»è¾‘ã€‚</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// é€šè¿‡æ–°çš„çŠ¶æ€æ›´æ–°</span><br>setState(updateState);<br><span class="hljs-comment">// å‡½æ•°å¼æ›´æ–°</span><br>setState(<span class="hljs-function"><span class="hljs-params">preState</span> =&gt;</span> preState + <span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure>

  <iframe
     src="https://codesandbox.io/embed/heuristic-driscoll-hskqs?fontsize=14&hidenavigation=1&theme=dark"
     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
     title="heuristic-driscoll-hskqs"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>

<h3 id="useEffect-Hook"><a href="#useEffect-Hook" class="headerlink" title="useEffect Hook"></a>useEffect Hook</h3><figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> type Effect = &#123;|<br>  tag: HookEffectTag,<br>  <span class="hljs-attr">create</span>: <span class="hljs-function">() =&gt;</span> (<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">void</span>) | <span class="hljs-keyword">void</span>, <span class="hljs-comment">// å­˜å‚¨ useEffect ä¼ å…¥çš„ callback</span><br>  <span class="hljs-attr">destroy</span>: (<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">void</span>) | <span class="hljs-keyword">void</span>, <span class="hljs-comment">// å­˜å‚¨ useEffect ä¼ å…¥çš„ callback çš„è¿”å›å‡½æ•°ï¼Œ</span><br>  <span class="hljs-attr">deps</span>: <span class="hljs-built_in">Array</span>&lt;mixed&gt; | <span class="hljs-literal">null</span>,<br>  <span class="hljs-attr">next</span>: Effect,<br>|&#125;;<br></code></pre></td></tr></table></figure>
<p>Effect å¤„ç†å‡½æ•°ç»„ä»¶ä¸­å‰¯ä½œç”¨ï¼šæ•°æ®è·å–ï¼Œè®¾ç½®è®¢é˜…ä»¥åŠæ‰‹åŠ¨æ›´æ”¹ React ç»„ä»¶ä¸­çš„ DOM</p>
<p>useEffect å¿…é¡»åœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨ï¼Œå¯ä»¥ç›´æ¥åœ¨ä½œç”¨åŸŸå†…è¯»å– state æˆ–è€… props  </p>
<p>ä¸ useState ä¼ å…¥å…·ä½“ state ä¸åŒï¼ŒuseEffectä¼ å…¥çš„æ˜¯ä¸€ä¸ª callback å‡½æ•°ã€‚<br>ä¸useState æœ€å¤§çš„ä¸åŒæ˜¯æ‰§è¡Œæ—¶æœºï¼ŒuseEffect æ˜¯åœ¨<strong>ç»„ä»¶è¢«æ¸²æŸ“ä¸ºçœŸå®DOMåæ‰§è¡Œ</strong>  </p>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹åå’Œæ¯æ¬¡æ›´æ–°ä¹‹åéƒ½ä¼šè°ƒç”¨ useEffect ä¸­çš„å‡½æ•°,å®ƒè®©æˆ‘ä»¬åœ¨å‡½æ•°ç»„ä»¶ä¸­å­˜å‚¨å†…éƒ¨ state </p>
</blockquote>
<p>Function Component ä¸å­˜åœ¨ç”Ÿå‘½å‘¨æœŸï¼Œä¸ç”¨å†å»è€ƒè™‘â€æŒ‚è½½â€è¿˜æ˜¯â€æ›´æ–°â€ï¼Œå³åŸæ¥åœ¨ class ç»„ä»¶ä¸­çš„ componentDidMountã€componentDidUpdate å’Œ componentWillUnmountã€‚ </p>
<p>ä¸ componentDidMount æˆ– componentDidUpdate ä¸åŒï¼Œä½¿ç”¨ useEffect è°ƒçš„ effect ä¸ä¼šé˜»å¡æµè§ˆå™¨æ›´æ–°å±å¹•ï¼Œè¿™è®©ä½ çš„åº”ç”¨çœ‹èµ·æ¥å“åº”æ›´å¿«(Effect æ˜¯å¼‚æ­¥æ“ä½œ)ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒEffect ä¸éœ€è¦åŒæ­¥åœ°æ‰§è¡Œã€‚åœ¨ä¸ªåˆ«æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚æµ‹é‡å¸ƒå±€ï¼‰æœ‰å•ç‹¬çš„ useLayoutEffect Hook ä¾›ä½ ä½¿ç”¨ï¼Œå…¶ API ä¸ useEffect ç›¸åŒã€‚</p>
  <figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> React, &#123; useState, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<br><br><span class="hljs-keyword">const</span> Example = <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  <span class="hljs-comment">// åœ¨æ‰§è¡Œ DOM æ›´æ–°ä¹‹åè°ƒç”¨</span><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// åœ¨renderåè¾“å‡ºç‚¹å‡»çš„æ¬¡æ•°</span><br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span>);<br>  &#125;);<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You clicked &#123;count&#125; times<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;</span><br><span class="xml">        CLICK CRAZY!</span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  );<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><p>å›æ”¶æœºåˆ¶ï¼šuseEffect æ¥å—ä¼ å…¥çš„ callback è¿”å›ä¸€ä¸ªå‡½æ•°æ¥æŒ‡å®šå¦‚ä½•â€œæ¸…é™¤â€ effectã€‚<br> åœ¨ç»„ä»¶è¢«é”€æ¯æ—¶ä¼šæ‰§è¡Œè¿”å›çš„å›è°ƒå‡½æ•°ã€‚</p>
</li>
<li><p>å¦‚æœä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œç›‘å¬æŸä¸ªstateå˜åŒ–è€Œæ‰§è¡Œã€å®ç°æ€§èƒ½ä¼˜åŒ–ï¼Œåœ¨ç›‘å¬çš„å…ƒç´ å‘ç”Ÿå˜åŒ–åæ‰è°ƒç”¨ effect; è‹¥ä¼ å…¥ç©ºçš„ä¾èµ–æ•°ç»„ []ï¼Œæ„å‘³ç€è¯¥ hook åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿è¡Œä¸€æ¬¡</p>
</li>
</ul>
<iframe
     src="https://codesandbox.io/embed/useeffectdeyilai-3jmdl?fontsize=14&hidenavigation=1&theme=dark"
     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
     title="useEffectçš„ä¾èµ–"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>
  
  <figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> React, &#123; useState, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Example</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  <span class="hljs-comment">// å¯ä»¥æ·»åŠ ç¬¬äºŒä¸ªå‚æ•°ã€åªè¦ç¬¬äºŒä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–ã€returnä¸­çš„æ–¹æ³•ä¹Ÿä¼šæ‰§è¡Œ</span><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span>);<br>    <span class="hljs-comment">// ç»„ä»¶é”€æ¯æ—¶æ‰§è¡Œ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Bye...&#x27;</span>);<br>    &#125;<br><br>  &#125;, [count]);<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You clicked &#123;count&#125; times<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;</span><br><span class="xml">        CLICK CRAZY!</span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Hook-ä½¿ç”¨äº†-JavaScript-çš„é—­åŒ…æœºåˆ¶"><a href="#Hook-ä½¿ç”¨äº†-JavaScript-çš„é—­åŒ…æœºåˆ¶" class="headerlink" title="Hook ä½¿ç”¨äº† JavaScript çš„é—­åŒ…æœºåˆ¶"></a>Hook ä½¿ç”¨äº† JavaScript çš„é—­åŒ…æœºåˆ¶</h3><p>å°† useEffect æˆ–è€…å…¶ä»– Hook æ”¾åœ¨ç»„ä»¶å†…éƒ¨è®©æˆ‘ä»¬å¯ä»¥åœ¨ effect ä¸­ç›´æ¥è®¿é—® state å˜é‡ï¼ˆæˆ–å…¶ä»– propsï¼‰</p>
<p>  <strong>capture value ç‰¹æ€§</strong>  </p>
<p>  é useRef çš„ hook æœ¬è´¨ä¸Šéƒ½å½¢æˆäº†é—­åŒ…ï¼Œæ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„çŠ¶æ€ï¼ˆå› ä¸ºé—­åŒ…çš„å€¼å®é™…ä¸Šä¸æ˜¯ reactive çš„ï¼Œï¼‰ã€‚  </p>
<p>  å¯ä»¥è®¤ä¸ºæ¯æ¬¡ render çš„å†…å®¹éƒ½ä¼šå½¢æˆä¸€ä¸ªå¿«ç…§å¹¶ä¿ç•™ä¸‹æ¥ï¼Œ å½“çŠ¶æ€å˜æ›´æ—¶ï¼Œå°±å½¢æˆäº†å¤šä¸ª Render çŠ¶æ€ï¼Œè€Œæ¯ä¸ª Render çŠ¶æ€éƒ½æ‹¥æœ‰è‡ªå·±å›ºå®šä¸å˜çš„ Props ä¸ Stateï¼Œå†…éƒ¨çš„å‡½æ•°åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ä¹Ÿæ˜¯ç‹¬ç«‹çš„ã€‚  </p>
<ul>
<li>æ‰€æœ‰ Hook é™¤äº† useRef éƒ½å…·æœ‰ capture value ç‰¹æ€§  </li>
<li>æ¯æ¬¡ Render éƒ½æœ‰è‡ªå·±çš„ Effects</li>
<li>æ¯æ¬¡ Render éƒ½æœ‰è‡ªå·±çš„ state å’Œ props</li>
</ul>
<p>  ä¼šå¯¼è‡´æœ‰çš„æ—¶å€™æ‹¿åˆ°çš„ state æˆ–è€… props æ˜¯æ—§å€¼ã€‚</p>
<h3 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h3><p>useState()çš„æ›¿ä»£æ–¹æ¡ˆ<br>æä¾›äº†åœ¨ç»„ä»¶å¤–é‡æ–°ç¼–æ’ state çš„èƒ½åŠ›<br>useReducer è¿”å›çš„ç»“æ„ä¸ useState å¾ˆåƒï¼Œåªæ˜¯æ•°ç»„ç¬¬äºŒé¡¹æ˜¯ dispatchï¼Œè€Œæ¥æ”¶çš„å‚æ•°ä¹Ÿæœ‰ä¸¤ä¸ªï¼Œåˆå§‹å€¼æ”¾åœ¨ç¬¬äºŒä½ï¼Œç¬¬ä¸€ä½å°±æ˜¯ reducerã€‚</p>
<p><strong>React ä¼šç¡®ä¿ dispatch å‡½æ•°çš„æ ‡è¯†æ˜¯ç¨³å®šçš„ï¼Œå¹¶ä¸”ä¸ä¼šåœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶æ”¹å˜</strong>ï¼ŒuseReducerè¿”å›çš„dispatchå¯¹è±¡åˆæ˜¯â€œæ€§èƒ½å®‰å…¨çš„â€ï¼Œå¯ä»¥ç›´æ¥æ”¾å¿ƒåœ°ä¼ é€’ç»™å­ç»„ä»¶è€Œä¸ä¼šå¼•èµ·å­ç»„ä»¶re-renderã€‚æ‰€ä»¥è¯´ <strong>æŠŠ dispatch æ”¾å…¥ä¾èµ–æ•°ç»„æ²¡ä»€ä¹ˆæ„ä¹‰</strong>ã€‚</p>
<p><strong>æŒ‡å®šåˆå§‹åŒ–state</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1 state = initialState</span><br><span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState);<br><span class="hljs-comment">// 2 state = init(initialArg) init() ç”¨äºè®¡ç®— state</span><br><span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialArg, init);<br></code></pre></td></tr></table></figure>

<!-- åŸºäºHooks Apiå¯ä»¥å®ç°ä¸€ä¸ªuseReducer Hook -->
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> useReducer = <span class="hljs-function">(<span class="hljs-params">reducer, initialArg, init</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> [state, setState] = useState(<br>    init ? <span class="hljs-function">() =&gt;</span> init(initialArg) : initialArg,<br>  );<br>  <span class="hljs-keyword">const</span> dispatch = useCallback(<br>    <span class="hljs-function"><span class="hljs-params">action</span> =&gt;</span> setState(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> reducer(prev, action)),<br>    [reducer],<br>  );<br>  <span class="hljs-keyword">return</span> useMemo(<span class="hljs-function">() =&gt;</span> [state, dispatch], [state, dispatch]);<br>&#125;;<br></code></pre></td></tr></table></figure>

<iframe
     src="https://codesandbox.io/embed/small-cloud-tmriz?fontsize=14&hidenavigation=1&theme=dark"
     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
     title="useReducer"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>

<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">state, action</span>) </span>&#123;<br>  <span class="hljs-comment">// èƒ½å¤Ÿæ‹¿åˆ°ç»„ä»¶çš„æ‰€æœ‰çš„ state</span><br>  <span class="hljs-keyword">switch</span> (action.type) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;INCREMENT&quot;</span>:<br>      <span class="hljs-keyword">return</span> &#123;<br>        ...state,<br>        <span class="hljs-attr">count</span>: state.count + state.step<br>      &#125;;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;DECREMENT&quot;</span>:<br>      <span class="hljs-keyword">return</span> &#123;<br>        ...state,<br>        <span class="hljs-attr">count</span>: state.count + state.step<br>      &#125;;<br>  &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params">props</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, &#123;<br>    <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">step</span>: <span class="hljs-number">10</span>,<br>  &#125;);<br>  <span class="hljs-keyword">const</span> &#123; count, step &#125; = state;<br><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      dispatch(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;INCREMENT&quot;</span> &#125;);<br>    &#125;, <span class="hljs-number">1000</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer);<br>    <span class="hljs-comment">// ä¾èµ– dispath æ²¡æœ‰å¤šå¤§çš„æ„ä¹‰</span><br>  &#125;, [dispatch]);<br><br>  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><p>æ•°æ®é€ä¼ ã€å‡å°‘ç»„ä»¶å±‚çº§ã€ç®€åŒ–äº†æ¶ˆè´¹ context çš„è¿‡ç¨‹</p>
<p>useContext çš„å‚æ•°å¿…é¡»æ˜¯ context å¯¹è±¡æœ¬èº«</p>
<p>è°ƒç”¨äº† useContext çš„ç»„ä»¶æ€»ä¼šåœ¨ context å€¼å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“  </p>
<iframe
     src="https://codesandbox.io/embed/friendly-morse-zzxrn?fontsize=14&hidenavigation=1&theme=dark"
     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
     title="friendly-morse-zzxrn"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>

<h3 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h3><figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> memorizeFn = useCallback(fn, deps)<br></code></pre></td></tr></table></figure>
<p>è¿”å›è¯¥å›è°ƒå‡½æ•° fn çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°  </p>
<p>ç»è¿‡ useCallback åŒ…è£…è¿‡çš„å‡½æ•°å¯ä»¥å½“ä½œæ™®é€šå˜é‡ä½œä¸º useEffect çš„ä¾èµ–ã€‚useCallback åšçš„äº‹æƒ…ï¼Œå°±æ˜¯åœ¨å…¶ä¾èµ–å˜åŒ–æ—¶ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°å¼•ç”¨ï¼Œè§¦å‘ useEffect çš„ä¾èµ–å˜åŒ–ï¼Œå¹¶æ¿€æ´»å…¶é‡æ–°æ‰§è¡Œã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> getFetchUrl = <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;https://v?query=&quot;</span> + count;<br>    &#125;<br><br>    getFetchUrl();<br>  &#125;, [count]);<br><br>  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;<br>&#125;<br><span class="hljs-comment">// åˆ©ç”¨ useCallback() å°†å‡½æ•°æ”¾åˆ° useEffect å¤–éƒ¨</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  <span class="hljs-keyword">const</span> getFetchUrl = useCallback(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;https://v?query=&quot;</span> + count;<br>  &#125;, [count]);<br><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    getFetchUrl();<br>  &#125;, [getFetchUrl]);<br><br>  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<!-- åè€Œæ›´å®¹æ˜“ä½¿æ€§èƒ½å˜å·® -->

<h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> memoizedValue = useMemo(<span class="hljs-function">() =&gt;</span> computeExpensiveValue(a, b), [a, b]);<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// useCallback ä¸ä¼šæ‰§è¡Œ fn è€Œæ˜¯å°†å…¶è¿”å›ï¼Œ useMemo åˆ™ä¼šæ‰§è¡Œ fn è¿”å›å…·ä½“çš„å€¼</span><br>useCallback(fn, deps) =&gt; useMemo(<span class="hljs-function">() =&gt;</span> fn, deps)<br></code></pre></td></tr></table></figure>

<p><strong>æ‰§è¡Œæ—¶æœºï¼š</strong> åœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œï¼ŒuseMemo() çš„è¿”å›å€¼å‚ä¸ render<br>  æŠŠâ€œåˆ›å»ºâ€å‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useMemoï¼Œå®ƒä»…ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚è¿™ç§ä¼˜åŒ–æœ‰åŠ©äºé¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¿›è¡Œé«˜å¼€é”€çš„è®¡ç®—ï¼Œç”¨äºç¼“å­˜ä¸€äº›è€—æ—¶çš„è®¡ç®—ç»“æœï¼Œåªæœ‰å½“ä¾èµ–å‚æ•°æ”¹å˜æ—¶æ‰é‡æ–°æ‰§è¡Œè®¡ç®—</p>
<p>  å¦‚æœæ²¡æœ‰æä¾›ä¾èµ–é¡¹æ•°ç»„ï¼ŒuseMemo åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè®¡ç®—æ–°çš„å€¼ã€‚<br>  è‹¥ç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºæ•°ç»„ï¼Œåˆ™åªä¼šåœ¨æ¸²æŸ“ç»„ä»¶æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œä¼ å…¥çš„å±æ€§å€¼çš„æ›´æ–°ä¹Ÿä¸ä¼šæœ‰ä½œç”¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">&#123; a, b &#125;</span>) </span>&#123;<br>  <span class="hljs-comment">// Only re-rendered if `a` changes:</span><br>  <span class="hljs-keyword">const</span> child1 = useMemo(<span class="hljs-function">() =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child1</span> <span class="hljs-attr">a</span>=<span class="hljs-string">&#123;a&#125;</span> /&gt;</span></span>, [a]);<br>  <span class="hljs-comment">// Only re-rendered if `b` changes:</span><br>  <span class="hljs-keyword">const</span> child2 = useMemo(<span class="hljs-function">() =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child2</span> <span class="hljs-attr">b</span>=<span class="hljs-string">&#123;b&#125;</span> /&gt;</span></span>, [b]);<br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="xml">      &#123;child1&#125;</span><br><span class="xml">      &#123;child2&#125;</span><br><span class="xml">    <span class="hljs-tag">&lt;/&gt;</span></span><br>  )<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><blockquote>
<p>useRef ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è¿”å›åŒä¸€ä¸ª ref å¯¹è±¡,  å¯ä»¥è®¤ä¸º ref åœ¨æ‰€æœ‰ Render è¿‡ç¨‹ä¸­ä¿æŒç€å”¯ä¸€å¼•ç”¨ã€‚ä¹Ÿå¯ä»¥è®¤ä¸ºï¼Œref æ˜¯ Mutable çš„ï¼Œè€Œ state æ˜¯ Immutable çš„</p>
</blockquote>
<ul>
<li>ç”¨ useRef è·å– React JSX ä¸­çš„ DOM å…ƒç´   </li>
<li>ç”¨useRefæ¥ä¿å­˜å˜é‡  </li>
<li>useRefæ˜¯æ‰€æœ‰Hooks APIé‡Œè¾¹å”¯ä¸€ä¸€ä¸ªè¿”å›mutableæ•°æ®çš„</li>
<li>ä¿®æ”¹useRefå€¼çš„å”¯ä¸€æ–¹æ³•æ˜¯ä¿®æ”¹å…¶currentçš„å€¼ï¼Œä¸”å€¼çš„å˜æ›´ä¸ä¼šå¼•èµ·re-render</li>
<li>æ¯ä¸€æ¬¡ç»„ä»¶renderæ—¶useReféƒ½è¿”å›å›ºå®šä¸å˜çš„å€¼ï¼Œ</li>
</ul>
<h3 id="è‡ªå®šä¹‰-hook"><a href="#è‡ªå®šä¹‰-hook" class="headerlink" title="è‡ªå®šä¹‰ hook"></a>è‡ªå®šä¹‰ hook</h3><blockquote>
<p>åˆ›å»ºè§„åˆ™ï¼š å‡½æ•°åéµå¾ªä»¥ use å¼€å¤´ï¼Œä¸”è¿”å›é JSX å…ƒç´ </p>
</blockquote>
<ul>
<li>ä½¿ç”¨è‡ªå®šä¹‰ Hook ä»ç»„ä»¶ä¸­æå–çŠ¶æ€é€»è¾‘ï¼Œä½¿å¾—è¿™äº›é€»è¾‘å¯ä»¥å•ç‹¬æµ‹è¯•å¹¶å¤ç”¨ã€‚</li>
</ul>
<iframe
     src="https://codesandbox.io/embed/interesting-sid-3tvcc?fontsize=14&hidenavigation=1&theme=dark"
     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
     title="customHook-usePrevious"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>


<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/hooks-overview.html">React Hooks æ–‡æ¡£</a> </p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/92211533?utm_source=wechat_session&utm_medium=social&utm_oi=29558355001344">React Hooks å®Œå…¨ä¸Šæ‰‹æŒ‡å—</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://overreacted.io/zh-hans/how-are-function-components-different-from-classes/">å‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/dt-fe/weekly/blob/v2/096.%E7%B2%BE%E8%AF%BB%E3%80%8AuseEffect%20%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E3%80%8B.md">ç²¾è¯»ã€ŠuseEffect å®Œå…¨æŒ‡å—ã€‹</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/">a-complete-guide-to-useeffect</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53375744">React ä½œè€…å…³äº Hooks çš„æ·±åº¦ issue</a></p>
</li>
</ul>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>å°åˆ«è‡´çœŸä¸œè¥¿<br>
        <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://heiliu.github.io/2019/11/18/reactHooks/" title="https:&#x2F;&#x2F;heiliu.github.io&#x2F;2019&#x2F;11&#x2F;18&#x2F;reactHooks&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;heiliu.github.io&#x2F;2019&#x2F;11&#x2F;18&#x2F;reactHooks&#x2F;</a><br>
        
            <strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬æ–‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> åè®®è¿›è¡Œè®¸å¯
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a><a class="nexmoefont icon-appstore-fill -link" href="/categories/%E5%89%8D%E7%AB%AF/React/">React</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/React/" rel="tag">React</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <div class="valine"></div>
<script src='https://cdn.jsdelivr.net/npm/valine'></script>
<script>
    // ä½¿ç”¨æ–¹æ³• https://valine.js.org/quickstart.html
    new Valine({
        el: '.valine',
        appId: 'nbKSzf8xLpdp0zGqwRkNJjeE-gzGzoHsz',
        appKey: '0WopfRxB7P9Q9CPleINLHXt1'
    })
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="å›åˆ°é¡¶éƒ¨" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1630502052182"></script>

<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?1b3ede68905f0bbb58c39b0e279d6246';
    var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>

</html>
